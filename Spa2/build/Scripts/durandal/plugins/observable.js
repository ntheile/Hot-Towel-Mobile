define(["durandal/system","durandal/binder","knockout"],function(e,t,n){function i(e){var t=e[0];return"_"===t||"$"===t}function r(t){if(!t||e.isElement(t)||t.ko===n||t.jquery)return!1;var i=d.call(t);return-1==f.indexOf(i)&&!(t===!0||t===!1)}function o(e,t){var n=e.__observable__,i=!0;if(!n||!n.__full__){n=n||(e.__observable__={}),n.__full__=!0,v.forEach(function(n){e[n]=function(){i=!1;var e=h[n].apply(t,arguments);return i=!0,e}}),m.forEach(function(n){e[n]=function(){i&&t.valueWillMutate();var r=g[n].apply(e,arguments);return i&&t.valueHasMutated(),r}}),p.forEach(function(n){e[n]=function(){for(var r=0,o=arguments.length;o>r;r++)a(arguments[r]);i&&t.valueWillMutate();var u=g[n].apply(e,arguments);return i&&t.valueHasMutated(),u}}),e.splice=function(){for(var n=2,r=arguments.length;r>n;n++)a(arguments[n]);i&&t.valueWillMutate();var o=g.splice.apply(e,arguments);return i&&t.valueHasMutated(),o};for(var r=0,o=e.length;o>r;r++)a(e[r])}}function a(t){var a,u;if(r(t)&&(a=t.__observable__,!a||!a.__full__)){if(a=a||(t.__observable__={}),a.__full__=!0,e.isArray(t)){var l=n.observableArray(t);o(t,l)}else for(var c in t)i(c)||a[c]||(u=t[c],e.isFunction(u)||s(t,c,u));b&&e.log("Converted",t)}}function u(e,t,n){var i;e(t),i=e.peek(),n?i.destroyAll||(i||(i=[],e(i)),o(i,e)):a(i)}function s(t,i,r){var s,l,c=t.__observable__||(t.__observable__={});if(void 0===r&&(r=t[i]),e.isArray(r))s=n.observableArray(r),o(r,s),l=!0;else if("function"==typeof r){if(!n.isObservable(r))return null;s=r}else e.isPromise(r)?(s=n.observable(),r.then(function(t){if(e.isArray(t)){var i=n.observableArray(t);o(t,i),t=i}s(t)})):(s=n.observable(r),a(r));return Object.defineProperty(t,i,{configurable:!0,enumerable:!0,get:s,set:n.isWriteableObservable(s)?function(t){t&&e.isPromise(t)?t.then(function(t){u(s,t,e.isArray(t))}):u(s,t,l)}:void 0}),c[i]=s,s}function l(t,n,i){var r,o=this,a={owner:t,deferEvaluation:!0};return"function"==typeof i?a.read=i:("value"in i&&e.error('For ko.defineProperty, you must not specify a "value" for the property. You must provide a "get" function.'),"function"!=typeof i.get&&e.error('For ko.defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".'),a.read=i.get,a.write=i.set),r=o.computed(a),t[n]=r,s(t,n,r)}var c,d=Object.prototype.toString,f=["[object Function]","[object String]","[object Boolean]","[object Number]","[object Date]","[object RegExp]"],v=["remove","removeAll","destroy","destroyAll","replace"],m=["pop","reverse","sort","shift","splice"],p=["push","unshift"],g=Array.prototype,h=n.observableArray.fn,b=!1;return c=function(e,t){var i,r,o;return e?(i=e.__observable__,i&&(r=i[t])?r:(o=e[t],n.isObservable(o)?o:s(e,t,o))):null},c.defineProperty=l,c.convertProperty=s,c.convertObject=a,c.install=function(e){var n=t.binding;t.binding=function(e,t,i){i.applyBindings&&!i.skipConversion&&a(e),n(e,t)},b=e.logConversion},c});